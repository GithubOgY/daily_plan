# MCPツール使用対策

## 問題の状況

- システムの説明では`call_mcp_tool`が利用可能と記載されている
- しかし、実際にはツールリストに`call_mcp_tool`が表示されない
- Google Maps MCPサーバーのスキーマファイルは存在している

## 考えられる原因

1. **Cursorの設定でMCPツールが有効化されていない**
2. **MCPサーバーが接続されていない**
3. **Cursorの再起動が必要**
4. **MCPサーバーの設定ファイルに問題がある**

## 対策方法

### 1. Cursorの設定を確認

1. Cursorを開く
2. 設定（Settings）を開く
3. 「MCP」または「Model Context Protocol」の設定を確認
4. `user-google-maps`サーバーが有効になっているか確認

### 2. MCPサーバーの接続状態を確認

1. Cursorのコマンドパレット（Ctrl+Shift+P）を開く
2. 「MCP」または「Model Context Protocol」で検索
3. MCPサーバーの接続状態を確認
4. エラーメッセージがある場合は確認

### 3. Cursorを再起動

1. Cursorを完全に終了
2. 再度起動
3. MCPサーバーが自動的に接続されるか確認

### 4. MCPサーバーの設定ファイルを確認

MCPサーバーの設定ファイルは通常、以下の場所にあります：
- Windows: `%APPDATA%\Cursor\User\globalStorage\mcp.json` または設定ファイル
- 設定ファイルで`user-google-maps`サーバーが正しく設定されているか確認

### 5. Google Maps APIキーの確認

1. Google Maps MCPサーバーが正しいAPIキーを使用しているか確認
2. APIキーが有効で、必要なAPI（Directions API、Distance Matrix APIなど）が有効になっているか確認

### 6. 代替方法

MCPツールが利用できない場合の代替方法：

#### A. 既存の予定ファイルから移動時間を参照
- 過去の予定ファイルに記載されている移動時間を参照
- 例：`2025-12-11_一日の予定.md`から「あじさい園 → 自宅：約15分」「自宅 → 叔父宅：約1時間」を参照

#### B. 一般的な移動時間の目安を使用
- **あじさい園 → 叔父宅（車）**: 約30-40km、通常約50-60分、ラッシュアワー考慮で約1時間
- **叔父宅 → 山科駅（徒歩）**: 約15分
- **山科駅 → 京都駅（地下鉄）**: 約15分
- **京都駅 → キャンパスプラザ京都（徒歩）**: 約5分

#### C. Web検索で移動時間を確認
- Google MapsのWebサイトで直接検索
- 移動時間を確認して予定ファイルに反映

## 現在の状況

現在、MCPツールが直接呼び出せないため、以下の方法で予定ファイルを更新しています：

1. **既存の予定ファイルのデータを参照**
   - 過去の予定ファイルから移動時間を抽出
   - 例：`2025-12-11_一日の予定.md`から「自宅 → 叔父宅：約1時間」を参照

2. **一般的な移動時間の目安を使用**
   - ラッシュアワー（17:00-19:00）は30分のバッファを追加
   - 既存の予定ファイルのパターンを参考に移動時間を設定

3. **予定ファイルを更新**
   - 計算した移動時間を予定ファイルに反映
   - スケジュール表、詳細メモ、注意事項を更新

## 今後の対応

MCPツールが利用可能になった場合：

1. **Google Maps APIを使用して正確な移動時間を計算**
   - `maps_directions`ツールで経路検索
   - `maps_distance_matrix`ツールで距離・時間を計算

2. **予定ファイルを自動更新**
   - 計算結果を予定ファイルに反映
   - ラッシュアワーを考慮した移動時間を設定

3. **移動時間の精度向上**
   - リアルタイムの交通状況を考慮
   - より正確な到着時刻を予測

## 確認事項

以下の点を確認してください：

- [ ] Cursorの設定でMCPツールが有効になっているか
- [ ] MCPサーバーが接続されているか
- [ ] Google Maps APIキーが正しく設定されているか
- [ ] 必要なAPI（Directions API、Distance Matrix API）が有効になっているか
- [ ] Cursorを再起動したか

## 参考情報

- MCPツールのスキーマファイル: `c:\Users\user\.cursor\projects\c-Users-user-Documents-cursor-practice\mcps/user-google-maps/tools/`
- 予定作成設定: `予定作成設定.json`
- 既存の予定ファイル: `2025-12-11_一日の予定.md`など

---

**作成日**: 2025年12月18日  
**目的**: MCPツールが使用できない場合の対策方法をまとめる

